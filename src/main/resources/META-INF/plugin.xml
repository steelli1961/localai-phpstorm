<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>com.ollama.plugin</id>
    <name>Ollama Chat Plugin</name>
    <vendor email="support@ollama.local" url="https://ollama.ai">Ollama Local</vendor>
    
    <description><![CDATA[
        A PhpStorm plugin for integrating Ollama AI models.
        
        Features:
        - Connect to local Ollama instance
        - Configure host and port
        - Auto-detect available models
        - Interactive chat interface
        - View metrics (memory, CPU, tokens/sec)
        - Execute prompts and get AI responses
        
        Requires PhpStorm 2025.3+
    ]]></description>

    <change-notes><![CDATA[
        <b>1.0.0</b>
        <ul>
        <li>Initial release with Ollama integration</li>
        <li>Settings configuration</li>
        <li>Tool window with chat interface</li>
        <li>Metrics display</li>
        </ul>
    ]]></change-notes>

    <idea-version since-build="251.0"/>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.jetbrains.php</depends>

    <extensions defaultExtensionNs="com.intellij">
        <applicationConfigurable 
            parentId="tools" 
            instance="com.ollama.plugin.settings.OllamaSettingsConfigurable" 
            id="com.ollama.plugin.settings"
            displayName="Ollama Configuration"/>
        
        <applicationService 
            serviceImplementation="com.ollama.plugin.settings.OllamaSettingsService"/>
        
        <applicationService 
            serviceImplementation="com.ollama.plugin.client.OllamaClient"/>
        
        <toolWindow 
            id="Ollama Chat" 
            anchor="right" 
            icon="AllIcons.Nodes.Plugin"
            factoryClass="com.ollama.plugin.ui.OllamaChatToolWindowFactory"/>

        <applicationService 
            serviceImplementation="com.ollama.plugin.service.CodeAnalysisService"/>
    </extensions>

    <actions>
        <action id="com.ollama.RefactorCode" class="com.ollama.plugin.action.RefactorCodeAction"
                text="Refactor Code with Ollama" description="Refactor selected code using Ollama">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt shift R"/>
        </action>
        <action id="com.ollama.ExplainCode" class="com.ollama.plugin.action.ExplainCodeAction"
                text="Explain Code" description="Get explanation for selected code">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt shift E"/>
        </action>
        <action id="com.ollama.OptimizeCode" class="com.ollama.plugin.action.OptimizeCodeAction"
                text="Optimize Code" description="Optimize selected code">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt shift O"/>
        </action>
        <action id="com.ollama.GenerateTests" class="com.ollama.plugin.action.GenerateTestsAction"
                text="Generate Tests" description="Generate unit tests for selected code">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt shift T"/>
        </action>
    </actions>
</idea-plugin>
